var v=Object.defineProperty;var y=(n,e,i)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var r=(n,e,i)=>(y(n,typeof e!="symbol"?e+"":e,i),i);import{j as u,a as k,R as d,b}from"./vendor.4384b2bd.js";const C=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(o){if(o.ep)return;o.ep=!0;const t=i(o);fetch(o.href,t)}};C();const s=u.exports.jsx,l=u.exports.jsxs,h=u.exports.Fragment,D=n=>{const{onClick:e}=n;return s(h,{children:s("button",{className:"btn-animate",onClick:e,children:"Buscar"})})},I=window.location.hostname==="localhost",m=I?"https://youtube-bamm.herokuapp.com/":`https://${window.location.hostname}`,N=(n,e="mp4")=>`${m}/watch?v=${n}&format=${e}`,S=n=>new RegExp(/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(\?\S*)?$/).test(n),x=()=>{const n=["\u{1F3B5}","\u{1F3BC}","\u{1F3B6}","\u{1F3BB}","\u{1F3B9}","\u{1F3BA}","\u{1F3A7}","\u{1F3A4}","\u{1F3A4}"],e=Math.floor(Math.random()*(n.length-1))+0;return n[e]},$=n=>{localStorage.setItem("format",n)},g=()=>localStorage.getItem("dark")==="true",f=k.create({baseURL:m,responseType:"json"}),L=async n=>{const{data:e}=await f.get(`/suggestions?search=${n}`);return e},j=async n=>{const{data:e}=await f.get(`/metainfo?url=${n}`);return e},M=({title:n,videoId:e,thumbnailUrl:i,handleDownload:a})=>s(h,{children:l("div",{className:"card",children:[l("a",{href:`https://youtube.com/watch?v=${e}`,rel:"noopener noreferrer",target:"_blank",children:[s("div",{className:"image",style:{backgroundImage:`url(${i})`}}),s("div",{className:"title",children:n})]}),l("button",{onClick:()=>a(e),className:"download",children:["Descargar ",x()]})]})});var F=d.memo(M);const B=({onClick:n})=>s(h,{children:s("div",{className:"btn-toggler",onClick:n,title:"Switch to Dark or Light Mode",children:s("svg",{viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:s("path",{d:"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"})})})}),R=[{id:"mp4",name:"MP4",isChecked:!0},{id:"mp3",name:"MP3"},{id:"mov",name:"MOV"},{id:"flv",name:"FLV"}];class U extends d.Component{constructor(){super(...arguments);r(this,"state",{input:"",filename:"",downloadUrl:"",format:"mp4",suggestions:[],downloads:[],currentVideoInfo:null,focus:!1,isDark:!1});r(this,"hiddenDownloadBtn",d.createRef());r(this,"writeCss",e=>{e?document.body.classList.add("dark"):document.body.classList.remove("dark")});r(this,"changeTheme",()=>{const e=!g();this.setState({isDark:!e}),localStorage.setItem("dark",`${e}`),this.writeCss(e)});r(this,"initialTheme",()=>{const e=g();this.setState({isDark:e},this.writeCss(e))});r(this,"handleChange",e=>{const{target:i}=e,{name:a,value:o}=i;this.setState({[a]:o},()=>{a==="format"&&$(o)})});r(this,"handleKeydown",e=>{e.keyCode===13&&this.checkInput()});r(this,"checkInput",()=>{const{input:e}=this.state;S(e)?this.download():this.fetchSuggestions()});r(this,"setFocus",()=>{this.setState({focus:!this.state.focus})});r(this,"fetchSuggestions",async()=>{const{input:e}=this.state,{data:i,success:a}=await L(e);a&&(this.setState({suggestions:i,currentVideoInfo:void 0}),console.log(i))});r(this,"download",async e=>{const{input:i,format:a}=this.state,o=e||i;if(!o)return;const{data:t,success:c}=await j(o);if(console.log("data ",t),c){const p=N(o,a),w={title:t.videoDetails.title,videoId:t.videoDetails.videoId};this.setState({downloadUrl:p,currentVideoInfo:t.videoDetails,downloads:[...this.state.downloads,w]},()=>{o&&this.hiddenDownloadBtn.click()})}});r(this,"handleDownloadClick",e=>{console.log(e),this.download(e)});r(this,"shouldSetPadding",()=>window.innerWidth>450&&this.state.downloads.length>0)}componentDidMount(){this.initialTheme()}render(){const{downloadUrl:e,focus:i,suggestions:a,currentVideoInfo:o}=this.state;return l(h,{children:[s(B,{onClick:this.changeTheme}),l("main",{className:"container",children:[l("section",{className:"search-section",children:[s("div",{className:`input-container ${i?"animate":""}`,children:s("input",{type:"text",name:"input",id:"text",placeholder:"Buscar titulo o Pegar url",spellCheck:!1,autoComplete:"off",onBlur:this.setFocus,onFocus:this.setFocus,onChange:this.handleChange,onKeyDown:this.handleKeydown,autoFocus:!0})}),s("ul",{className:"format-list",children:R.map(t=>l("li",{children:[s("input",{type:"radio",name:"format",value:t.name,onChange:this.handleChange,id:t.id,checked:t.name===this.state.format}),s("label",{htmlFor:t.id,className:"radio-label",children:t.name})]},t.id))}),s(D,{onClick:this.checkInput})]}),o&&s("section",{className:"downloading-section",children:l("div",{children:[s("h2",{children:o.title}),s("img",{src:`https://i.ytimg.com/vi/${o.videoId}/hqdefault.jpg`,alt:o.title})]})}),l("section",{className:"suggestions-section",children:[!!a.length&&s("h1",{children:"Sugerencias"}),s("div",{className:"grid",children:a.map(t=>{const{snippet:c}=t;return s(F,{title:c.title,videoId:t.id.videoId,description:c.description,thumbnailUrl:c.thumbnails.medium.url,handleDownload:this.handleDownloadClick},t.id.videoId)})})]})]}),s("footer",{className:"footer"}),s("a",{href:e,download:!0,className:"hidden",ref:t=>this.hiddenDownloadBtn=t,children:e})]})}}b.render(s(d.StrictMode,{children:s(U,{})}),document.getElementById("root"));
